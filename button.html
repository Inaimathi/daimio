<!doctype html> 
<html> 
<head> 
  <title>Push My Button!</title>
  <script type="text/javascript" src="http://sherpa.local/~dann/katsu/nodely/__underscore.js"></script>
  <script type="text/javascript" src="http://sherpa.local/~dann/daimio/get.php?file=node_modules/daml"></script>
</head>

<body>

  <div id="counter_div">
    <p>The button has been pushed <span id="count">0.01</span> times!</p>
  </div>
  
  <form id="button_form">
    <p><input type="submit" value="Click me!!"></p>
  </form>
  
  <script type="text/daml" id="hello_daimio">
    {// establish #count gateway}
    { channel add name :counter 
    | channel attach 
        side :end
        gateway {gateway add type :dom-text thing :count name :setcount}
    | channel send name :counter value 47
    | 48 | @>counter}
    
    {/5555 | add 5}
    
    {// establish #button_form gateway}
    {//3 | process wait for 1000 | add 99}
    {//3 | process wait for 1000 then "{__}" | add 99}
    {//2 | add 4}
    
  </script>
  
  <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function() {
      var code = document.getElementById('hello_daimio')
      DAML.run(code.text)
    })
  </script>
  
  <!-- 
  
    DAML.run('{range 500 | map block "{__ | process wait for 1 | times __ | channel send name :counter}"}')
    
    
   -->
</body>
</html>