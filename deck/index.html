<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>Sneaking a peek at Daimio</title>
	
	<meta name="description" content="A language for sharing">
	<meta name="author" content="dann toliver">
	<meta name="viewport" content="width=1024, user-scalable=no">
	
	<!-- Core and extension CSS files -->
	<link rel="stylesheet" href="core/deck.core.css">
  <!-- <link rel="stylesheet" href="../extensions/goto/deck.goto.css">
  <link rel="stylesheet" href="../extensions/menu/deck.menu.css">
  <link rel="stylesheet" href="../extensions/hash/deck.hash.css">
  <link rel="stylesheet" href="../extensions/navigation/deck.navigation.css">
  <link rel="stylesheet" href="../extensions/status/deck.status.css">
  <link rel="stylesheet" href="../extensions/scale/deck.scale.css"> -->

	
	<!-- Style theme. More available in /themes/style/ or create your own. -->
	<link rel="stylesheet" href="themes/style/swiss.css">
	
	<!-- Transition theme. More available in /themes/transition/ or create your own. -->
	<link rel="stylesheet" href="themes/transition/horizontal-slide.css">
	
	<script src="modernizr.custom.js"></script>
</head>

<body class="deck-container">

<!-- Begin slides -->
<section class="slide" id="title-slide">
  <h1>
    <span style="font-size:0.4em">Sneaking a peek at</span>
    <p>Daimio</p>
    <span style="font-size:0.2em">A conversation in three acts</span>
  </h1>
</section>

<section class="slide" id="motivation">
  <h1>
    Act I
    <p style="font-size:0.4em">Motivation</p>
  </h1>
</section>

<section class="slide" id="use-cases">
	<h2>Use cases</h2>
	<ol>
		<li>
			<h3>Internal Enterprise Applications</h3>
			<p></p>
		</li>
		<li>
			<h3>Enterprise-focused Services</h3>
			<p></p>
		</li>
    <li>
      <h3>Tool-based Services</h3>
      <p></p>
    </li>
    <li>
      <h3>Web-based games</h3>
      <p></p>
    </li>
	</ol>
</section>

<section class="slide" id="you">
  <h2>Your app vs Excel</h2>
  
  <div class="slide">
    <h3>Your app:</h3>
    <ul>
      <li><h3>location agnostic (use anywhere)</h3></li>
      <li><h3>device agnostic (on anything)</h3></li>
      <li><h3><small>(de)</small>centralized data (it's "in the cloud")</h3></li>
    </ul>
  </div>
  
  <p class="slide">
    <span style="color:red">But those are all benefits of the web!</span>
  </p>  
</section>

<section class="slide" id="excel-saga">
  <h2>Benefits of Excel<sup>*</sup></h2>
  
  <ul>
    <li><h3>Customizable interaction</h3></li>
    <li><h3>Customizable functionality</h3></li>
    <li><h3>Sharable customizations</h3></li>
  </ul>
  
  <aside>
    <sup>*</sup> <small>For demonstration purposes only. Not responsible for actual use of Excel. </small>
  </aside>
</section>

<section class="slide" id="goal">
  <h1 style="font-size:1em;">
    <p style="color:grey">Excel is the new paper-based system</p>
    <p class="slide">
      I want the web to be the new Excel
    </p>
  </h1>
</section>

<section class="slide" id="if-youre-having-web-problems">
  <h2>Problems with corporate tools</h2>
  
  <ul>
    <li>Unforeseen uses</li>
    <li>Inefficient pathways</li>
    <li>Different strokes</li>
    <li>Enhancement requests</li>
    <li>Bug fixes</li>
    <li></li>
  </ul>
</section>

<section class="slide" id="progweb">
  <h2>Solution: The Programmable Web</h2>
  
  <p>Way beyond just APIs</p>

  <h3>Benefits</h3>
  
  <ul>
    <li>crowd-sourced interfaces</li>
    <li>enhanced functionality</li>
    <li>marketplace for innovation</li>
  </ul>
  
  <p>Act now and get it for free!</p>
</section>


<section class="slide" id="slide17">
  <h1 style="font-size:1em; color:grey">Wherein the vision is imparted</h1>
</section>

<section class="slide" id="nothing">
</section>

<section class="slide" id="gamesyousay">
  <h2>You said something about games...</h2>
  
  <ul>
    <li>programmable world</li>
    <li>humans vs bots (free AI)</li>
    <li>client-based MMO</li>
  </ul>
</section>


<section class="slide" id="needs">
	<h2>Needs ways to:</h2>
	<ol>
		<li class="slide">
			<h3>Craft interfaces</h3>
		</li>
    <li class="slide">
      <h3>Add functionality to them</h3>
    </li>
    <li class="slide">
      <h3>Modify that functionality</h3>
    </li>
    <li class="slide">
      <h3>Share modified functionality with others</h3>
    </li>
    <li class="slide">
      <h3>Run modified functionality on server</h3>
    </li>
	</ol>
</section>




<section class="slide" id="daimio">
  <h1>
    Act II
    <p style="font-size:0.5em">Daimio</p>
  </h1>
</section>

<section class="slide" id="is-a-lang">
  <h2>Daimio is a language</h2>
  <ul>
		<li class="slide">
      "Types": numbers, strings, lists, commands:
      <pre><code>{ ( 123 "foo" (1 2 3) ) }</code></pre>
    </li>
		<li class="slide">
      Commands have named params:
      <pre><code>{math add value 3.14 to 2}</code></pre>
    </li>
		<li class="slide">
      Lists can be keyed:
      <pre><code>{* (:x 5 :y -12) }</code></pre>
    </li>
  </ul>
</section>

<section class="slide" id="is-a-dataflow">
  <h2>Daimio is a dataflow language</h2>
  <pre><code>
    {41 | add 1}
    {(1 2 3) | add}
    {(1 2 3) | add 1}
    {(1 2 3) | add (3 2 1)}
    
    {(1 2 3) | map block "{__ | add 5 | mod 7}"}
  </code></pre>
</section>

<section class="slide" id="for-sharing">
  <h2>Daimio is a language for sharing</h2>
  <ul>
		<li class="slide">
      Commands are permissible
    </li>
		<li class="slide">
      Dialects contain commands
    </li>
		<li class="slide">
      Execution context has a dialect
    </li>
  </ul>
</section>

<section class="slide" id="is-a-dataflow">
  <h2>Daimio is extensible</h2>
  <ul>
    <li class="slide">
      You publish commands to create your application's functionality
    </li>
    <li class="slide">
      Create specialized dialects within your app
    </li>
  </ul>
</section>

<section class="slide" id="is-a-dataflow">
  <h2>Daimio is a universal language</h2>
  <ul>
    <li class="slide">
      Used by ops, devs, designers, marketeering, business folk and end users
    </li>
    <li class="slide">
      The command list is your API 
    </li>
    <li class="slide">
      Design your API first, enjoy concurrent development
    </li>
  </ul>
</section>

<section class="slide" id="for-sharing">
  <h2>Daimio is not general purpose</h2>
  <p>General purpose implies breadth of features and low-level control</p>
  <ul>
		<li class="slide">
      Domain specific, for your specific domain
    </li>
		<li class="slide">
      A gift you give your users
    </li>
		<li class="slide">
      Control over the parts that matter
    </li>
		<li class="slide">
      Performance issues? Add a new command (i.e. do it in JS)
    </li>
		<li class="slide">
      Unwieldy? Add a new command
    </li>
  </ul>
</section>

<section class="slide" id="is-a-vm">
  <h2>Daimio is a virtual machine</h2>
  <ul>
    <li class="slide">
      Segments is an array of numbers, strings, "lists", and commands
    </li>
    <li class="slide">
      Wiring is a set of directed edges between segments
    </li>
    <li class="slide">
      Wiring forms a DAG
    </li>
    <li class="slide">
      Lists and commands are exploded
    </li>
    <li class="slide">
      {segments: ___, wiring: ___} is expressible in JSON
    </li>
  </ul>
</section>

<section class="slide" id="is-a-dataflow">
  <h2>Daimio is a framework</h2>
  <ul>
    <li class="slide">
      A space is an execution context: a dialect and state
    </li>
    <li class="slide">
      Spaces send and receive messages via ports 
    </li>
    <li class="slide">
      A space can contain subspaces, which inherit its dialect
    </li>
    <li class="slide">
      A space can contain code blocks, each wrapped in a station
    </li>
    <li class="slide">
      Stations have ports too
    </li>
  </ul>
</section>


---: cut to button examples



<section class="slide" id="is-a-dataflow">
  <h2>Daimio has "types"</h2>
  <ul>
    <li class="slide">
      Types for data: numbers, strings, lists
    </li>
    <li class="slide">
      Types for params: integers, blocks, tree, [number], number|[number]
    </li>
    <li class="slide">
      Types for ports: db, dom, network, audio, svg
    </li>
  </ul>
</section>

<section class="slide" id="is-projectional">
  <h2>Daimio is projectional</h2>
  <ul>
    <li class="slide">
      Code is not the final artifact; VM data structure is
    </li>
    <li class="slide">
      VM data can be projected back into code form
    </li>
    <li class="slide">
      Could be projected into other forms too
    </li>
    <li class="slide">
      All projected representations are equivalent
    </li>
    <li class="slide">
      (Though not all are first class)
    </li>
    <li class="slide">
      "There's more than one way to view it"
    </li>
  </ul>
</section>

<section class="slide" id="is-projectional">
  <h2>Spaces are data too</h2>
  <ul>
    <li class="slide">
      JSON-representable data structure, like Daimio code
    </li>
    <li class="slide">
      Like Daimio code, representable in multiple ways 
    </li>
    <li class="slide">
      Immutable and uniquely id'd regardless of manufacturer 
    </li>
  </ul>
</section>

<section class="slide" id="is-projectional">
  <h2>Spaces are immutable</h2>
  <ul>
    <li class="slide">
      Routes are defined at compile time
    </li>
    <li class="slide">
      No one knows what's outside
    </li>
    <li class="slide">
      A component with a given ID will *always* behave the same
    </li>
    <li class="slide">
      Memoizable over ship + state
    </li>
    <li class="slide">
      Requires propagating changes upward on edit
    </li>
    <li class="slide">
      FBP
    </li>
  </ul>
</section>

<section class="slide" id="has-diish">
  <h2>Daimio has DI (ish)</h2>
  <ul>
    <li class="slide">
      Inside a space, the outer world is only seen through arriving messages
    </li>
    <li class="slide">
      The outer space attaches to the outside through ports
    </li>
    <li class="slide">
      Database access is handled through "synchronized asynchronous" ports (send-and-receive)
    </li>
    <li class="slide">
      Likewise for random numbers, current date, anything impure
    </li>
    <li class="slide">
      Benefits of dependency injection vis-a-vis testing
    </li>
    
  </ul>
</section>

<section class="slide" id="is-pureish">
  <h2>Daimio is pure (ish)</h2>
  <ul>
    <li class="slide">
      Inside a space, the outer world is only seen through arriving messages
    </li>
    <li class="slide">
      The outer space attaches to the outside through ports
    </li>
    <li class="slide">
      Database access is handled through "synchronized asynchronous" ports (send-and-receive)
    </li>
    <li class="slide">
      Likewise for random numbers, current date, anything impure
    </li>
    <li class="slide">
      Benefits of dependency injection vis-a-vis testing
    </li>
    <li class="slide">
      Benefits of purity as well (memo, opt, replay, etc)
*  break this out more? stm, ameoba, etc.
    </li>
    <li class="slide">
      
    </li>
  </ul>
</section>







<section class="slide" id="techniques">
  <h1>
    Act III
    <p style="font-size:0.4em">Techniques</p>
  </h1>
</section>

<section class="slide" id="were-doing-it">
  <h2>We're doing this now</h2>
  <ul>
    <li class="slide">
      Six years of stable development 
    </li>
    <li class="slide">
      Puts power where it belongs
    </li>
    <li class="slide">
      Minimizes dev/design turn around
    </li>
    <li class="slide">
      Unit tests == integration tests
    </li>
    <li class="slide">
      Often trivial to add new features
    </li>
  </ul>
</section>

<section class="slide" id="howie-do-it">
  <h2>How we do it</h2>
  <ul>
    <li class="slide">
      Determine commands (shared language)
    </li>
    <li class="slide">
      Views are just Daimio code (single API)
    </li>
    <li class="slide">
      Controllers are Daimio code sent to server
    </li>
    <li class="slide">
      Models are mechanically robust 
    </li>
    <li class="slide">
      But ignorant of 'soft' parts
    </li>
    <li class="slide">
      Perms and attrs handle the fluffy bits
    </li>
  </ul>
</section>


<section class="slide" id="concpar1">
  <h2>Concurrency vs Parallelism</h2>
  <ul>
    <li>
      You have 1,000 independent tasks to perform
    </li>
    <li>
      Each takes 1 second
    </li>
    <li>
      One core? 1,000 seconds
    </li>
    <li>
      Four cores? ~250 seconds
    </li>
    <li>
      Parallelism is easy
    </li>
  </ul>
</section>

<section class="slide" id="concpar2">
  <h2>Concurrency vs Parallelism</h2>
  <ul>
    <li>
      You have 1,000 independent tasks to perform
    </li>
    <li>
      Each takes 1 second, but requires no processing
    </li>
    <li>
      With concurrency? ~1 second
    </li>
  </ul>
</section>

<section class="slide" id="concpar3">
  <h2>Concurrency vs Parallelism</h2>
  <ul>
    <li>
      You have 1,000 independent tasks to perform
    </li>
    <li>
      Each takes 1 second, but requires no processing
    </li>
    <li class="slide">
      Except it initially reads a counter, then increments it when done
    </li>
    <li class="slide">
      ...
    </li>
    <li class="slide">
      Concurrency is hard
    </li>
  </ul>
</section>

<section class="slide" id="concpar3">
  <h2>Concurrency</h2>
  <ul>
    <li>
      JS avoids critical section issues
    </li>
    <li>
      Unless you go async, but it's obvious when that happens
    </li>
    <li class="slide">
      Unless it isn't...
    </li>
    <li class="slide">
      Spaces confine state
    </li>
    <li class="slide">
      And have rules to limit concurrency
    </li>
    <li class="slide">
      Maybe STM too
    </li>
  </ul>
</section>


<section class="slide" id="makes-it-tick">
  <h2>Techniques that make Daimio tick</h2>
  <ul>
    <li>
      Technique 1: Trampoline
    </li>
    <li>
      Technique 2: NaN poison
    </li>
    <li>
      Technique 3: MungeLR
    </li>
  </ul>
</section>

<section class="slide" id="tramp1">
  <h2>Trampolines</h2>
  <ul>
    <li>
      Magical async makes you think of CPS
    </li>
    <li>
      CPS gives us control over async (just call cont instead of return)
    </li>
    <li>
      JS: no native continuations, but we have closures
    </li>
    <li>
      No TCO, though, so the call stack explodes
    </li>
    <li>
      Answer: trampoline!
    </li>
  </ul>
</section>

<section class="slide" id="tramp2">
  <h2>Trampolines</h2>
  <pre><code>
function trampoline(x) {
  while (x && x.fun)
    x = x.fun.apply(null, x.args)
}

function f(callback){
  return ++n > 1000 ? callback(n) : {fun:f, args:[callback]}
}

n = 0; start = Date.now(); trampoline({fun:f, args:[function() {console.log(Date.now() - start)}]})
  </code></pre>
</section>

<section class="slide" id="tramp3">
  <h2>Trampolines</h2>
  <ul>
    <li>
      We need to trampoline every time we might go async
    </li>
    <li>
      So map, reduce, filter -- anything that accepts a pipeline
    </li>
    <li>
      Let's make it as easy as possible
    </li>
  </ul>
</section>

<section class="slide" id="tramp4">
  <h2>Daimio Map</h2>
  <pre><code>function(data, block, prior_starter, process) {
  var scope = {}
  
  var processfun = function(item, prior_starter) {
    scope["*in"] = item
    return block(function(value) 
      {prior_starter(value)
    }, scope, process)
  }

  return D.dataTrampoline(data, processfun, DAML.list_push, prior_starter)
}
  </code></pre>
</section>

<section class="slide" id="tramp5">
  <h2>Trampolines</h2>
  <pre><code>
D.dataTrampoline = function(data, processfun, joinerfun, finalfun, prior_starter) {
  var keys = Object.keys(data)
    , size = keys.length
    , index = -1
    , result = joinerfun()
    , asynced = false
    , value

  finalfun = finalfun || function(x) {return x}

  var inner = function() {
    while(++index < size) {
      var key = keys[index]
      value = processfun(data[key], my_starter, key, result)
      if(value !== value) {
        asynced = true
        return NaN
      }
      result = joinerfun(result, value)
    }

    if(asynced)
      return prior_starter(finalfun(result))

    return finalfun(result)
  }

  var my_starter = function(value) {
    result = joinerfun(result, value)
    inner()
  }

  return inner()
}
  </code></pre>
</section>

<section class="slide" id="stack1">
  <h2>Poisoning the Stack</h2>
  <ul>
    <li>
      Everything has to pass a callback in case of async
    </li>
    <li>
      If you go too deep you blow the stack
    </li>
    <li>
      So return if you don't go async
    </li>
    <li>
      But now you have two <strike>problems</strike> processes
    </li>
  </ul>
</section>

<section class="slide" id="stack1">
  <h2>Poisoning the Stack</h2>
  <ul>
    <li>
      Solution: return a proper value if sync
    </li>
    <li>
      Return poison on async
    </li>
    <li>
      We use NaN for poison
    </li>
    <li>
      if(value !== value) return NaN
    </li>
  </ul>
</section>

<section class="slide" id="stack1">
  <h2>Stack Inversion</h2>
  <ul>
    <li>
      On re-entry, the stack is built backwards, from the innermost function up
    </li>
    <li>
      Those new layers are the skeletal remains of the past adventure
    </li>
    <li>
      The remain until the process completely ends (return cascade)
    </li>
    <li>
      Or the next async call smashes the stack
    </li>
  </ul>
</section>

<section class="slide" id="stack1">
  <h2>The Munger</h2>
  <ul>
    <li>
      Say you wanted to perform a function over some data items
    </li>
  </ul>
</section>



mungelr / catamorphisms








<section class="slide" id="finally">
  <h1>
    http://sherpa.local:8008
  </h1>
  <ul>
    <li>mungelr gist</li>
    <li>datatramp gist</li>
    <li>slides</li>
    <li>twitter</li>
    <li>email</li>
  </ul>
</section>







<section class="slide" id="elements-images">
	<h2>Other Elements: Images</h2>
	<img src="http://placekitten.com/600/375" alt="Kitties">
	<pre><code>&lt;img src=&quot;http://placekitten.com/600/375&quot; alt=&quot;Kitties&quot;&gt;</code></pre>
</section>

<section class="slide" id="elements-blockquotes">
	<h2>Other Elements: Blockquotes</h2>
	<blockquote cite="http://example.org">
		<p>Food is an important part of a balanced diet.</p>
		<p><cite>Fran Lebowitz</cite></p>
	</blockquote>
	<pre><code>&lt;blockquote cite=&quot;http://example.org&quot;&gt;
  &lt;p&gt;Food is an important part of a balanced diet.&lt;/p&gt;
  &lt;p&gt;&lt;cite&gt;Fran Lebowitz&lt;/cite&gt;&lt;/p&gt;
&lt;/blockquote&gt;</code></pre>
</section>



<!-- Grab CDN jQuery, with a protocol relative URL; fall back to local if offline -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="../jquery-1.7.2.min.js"><\/script>')</script>

<!-- Deck Core and extensions -->
<script src="core/deck.core.js"></script>
<script src="extensions/hash/deck.hash.js"></script>

<!-- Initialize the deck -->
<script>
$(function() {
	$.deck('.slide');
});
</script>

</body>
</html>
