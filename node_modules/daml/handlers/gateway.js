// A gateway is a connection to another world. there's many types of gateway, which are configured somehow by someone.

DAML.import_models({
  gateway: {
    desc: 'Commands for gateway manipulation',
    methods: {
      
      add: {
        desc: 'Add a new gateway',
        params: [
          { key: 'name'
          , desc: 'The name for the gateway -- currently needs to be unique systemwide'
          , type: 'string'
          , required: true
          }
        , { key: 'type'
          , desc: 'One of the pre-configured gateway types [limited by spacial accessibility]'
          , type: 'string'
          , required: true
          }
        , { key: 'thing'
          , desc: 'Passed in to the gateway type'
          , type: 'anything'
          }
        ],
        fun: function(name, type, thing) {
          DAML.add_gateway(name, type, thing)
          
          // THINK: how do we constrain which spaces have access to this gateway??
          return name
        },
      },
      
      send: {
        desc: "Send a value directly into a gateway",
        params: [
          {
            key: 'name',
            desc: 'A gateway name',
            type: 'string',
            required: true
          },
          {
            key: 'value',
            desc: 'A value to send',
            type: 'anything',
            required: true
          },
        ],
        fun: function(name, value, callback) {
          var gateway = DAML.GATEWAYS[name]
          
          if(!gateway)
            return DAML.setError('That is not a valid gateway')
          
          return gateway.sendMessage(value, callback)
          
          // return NaN
        },
      },
      
    }
  }
})