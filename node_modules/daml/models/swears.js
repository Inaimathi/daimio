/*

- switch over to return 3 mode in automata (bottom of file), and optimize the add/remove stuff from there.

*/

// revamp swears add/remove/moveup/movedown -- layer.remove in particular is ghastly with 10k+ layers.
// also, reconsider stomp/squish/collide etc. there's a lot of weird cases. needs much work.

// cancel keystroke if mod keys are pressed
// revamp key stuff so it doesn't trigger twice when tapped

// make a 'swears do_mask' command, which takes cx, cy, shape, size, and template and then does the template for each x/y. (sets x/y local vars)

// figure out this event loop thing once and for all.

/* SO... the problems for errant item destruction are:

- when a Katsu thing is destroyed, the corresponding layer is removed, but there's still a reference in the current playboard
- if we really think of all the actions in a round happening simultaneously, then it doesn't make sense to have stomp and squished for two moving things -- they really do collide. s/s only works if one thing is stationary. 
- swears seems to trigger for each square in the layer -- if you overlap something by a few squares, you'll call these things multiple times. should probably track that. 

--> short term solution: be okay with irrelevant destruction, fix the other stuff later.

finger = DAML.fingify('{thing spawn template :antisporeshot direction :e x x y y}');
for(x=0;x < 50;x++) { 
  for(y=0;y < 30;y++) { 
    DAML.VARS.x = x; DAML.VARS.y = y;
    finger.run();
}}


*/




// player: {
//   desc: "Methods for maze interaction",
//   methods: {
//     act: {
//       desc: "Take an action",
//       fun: function(id, action) {
//         Katsu.things[id].traitkeys[action].go();
//       },
//       params: {
//         id: {
//           desc: "The thing's id",
//           fallback: now.id,
//         },
//         action: {
//           desc: "The desired action",
//         },
//       }
//     },
//   },
// },
